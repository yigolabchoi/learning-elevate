# Learning Elevate - Cursor Rules

## 프로젝트 개요

Learning Elevate는 선생님/강사를 위한 AI 기반 학습 향상 플랫폼입니다.
교사가 정의한 커리큘럼을 바탕으로 학생 수준에 맞는 문제를 자동 생성하고,
학생 답안을 AI가 분석하여 취약 영역을 설명·보완하며,
교사는 이를 검토·컨펌만 하는 구조의 서비스입니다.

## 문서 우선 개발 원칙

**모든 개발은 docs/ 폴더의 문서를 기준으로 진행합니다.**

### 필수 참조 문서

1. **기획 문서** (`docs/planning/`)
   - [서비스 기획서](docs/planning/service-plan.md) - 서비스 개요 및 핵심 가치
   - [기능 명세서](docs/planning/feature-specification.md) - 상세 기능 정의
   - [사용자 시나리오](docs/planning/user-scenarios.md) - 사용자별 시나리오

2. **디자인 문서** (`docs/design/`)
   - [디자인 시스템](docs/design/design-system.md) - 색상, 타이포그래피, 간격 등
   - [컴포넌트 라이브러리](docs/design/component-library.md) - 재사용 가능한 UI 컴포넌트
   - [화면 설계서](docs/design/screen-design.md) - 주요 화면 구조 및 IA

3. **개발 문서** (`docs/development/`)
   - [개발 환경 설정](docs/development/setup-guide.md) - 로컬 개발 환경 구축
   - [프로젝트 구조](docs/development/project-structure.md) - 폴더 구조 및 파일 구성
   - [코딩 컨벤션](docs/development/coding-conventions.md) - 코드 작성 규칙
   - [데이터베이스 스키마](docs/development/database-schema.md) - DB 설계 및 ERD

4. **API 문서** (`docs/api/`)
   - [API 명세서](docs/api/api-specification.md) - RESTful API 엔드포인트 정의

## 개발 규칙

### 1. 코드 작성 전 문서 확인

새로운 기능을 개발하기 전에 반드시 다음을 확인하세요:

```
1. 기능 명세서에서 해당 기능의 요구사항 확인
2. 화면 설계서에서 UI/UX 구조 확인
3. 데이터베이스 스키마에서 데이터 모델 확인
4. API 명세서에서 엔드포인트 구조 확인
5. 디자인 시스템에서 사용할 컴포넌트 및 스타일 확인
```

### 2. 코딩 컨벤션 준수

**TypeScript/JavaScript**
- 변수/함수: camelCase
- 클래스/타입: PascalCase
- 상수: UPPER_SNAKE_CASE
- Boolean: is/has/should 접두사

**React/Next.js**
- 함수형 컴포넌트 사용
- Props는 구조 분해
- 커스텀 훅은 use 접두사
- Early return 패턴 사용

**파일명**
- 컴포넌트: PascalCase (예: `Button.tsx`)
- 유틸리티: camelCase (예: `formatDate.ts`)
- 상수: UPPER_SNAKE_CASE (예: `API_ENDPOINTS.ts`)

### 3. 디자인 시스템 준수

**색상**
```typescript
// ✅ Good: 디자인 시스템의 색상 변수 사용
className="bg-primary-500 text-white"

// ❌ Bad: 임의의 색상 사용
className="bg-blue-500 text-white"
```

**간격**
```typescript
// ✅ Good: 8px 기반 간격 시스템 사용
className="p-4 mb-6" // 16px, 24px

// ❌ Bad: 임의의 간격
className="p-3 mb-5"
```

**타이포그래피**
```typescript
// ✅ Good: 정의된 타이포그래피 클래스 사용
<h1 className="heading-1">제목</h1>
<p className="body-base">본문</p>

// ❌ Bad: 임의의 폰트 크기
<h1 className="text-[32px]">제목</h1>
```

### 4. 컴포넌트 재사용

**새로운 UI 컴포넌트를 만들기 전에:**

1. `docs/design/component-library.md`에서 기존 컴포넌트 확인
2. 기존 컴포넌트로 조합 가능한지 검토
3. 정말 필요한 경우에만 새로운 컴포넌트 생성
4. 생성 시 컴포넌트 라이브러리 문서에 추가

```tsx
// ✅ Good: 기존 컴포넌트 사용
import { Button, Card, Input } from '@/components/ui';

// ❌ Bad: 매번 새로운 버튼 컴포넌트 생성
const MyCustomButton = () => { ... }
```

### 5. API 개발

**API 엔드포인트 개발 시:**

1. `docs/api/api-specification.md`의 명세를 정확히 따름
2. 요청/응답 형식 준수
3. 에러 코드 및 메시지 일관성 유지
4. 페이지네이션 형식 통일

```typescript
// ✅ Good: API 명세서의 응답 형식 준수
return {
  success: true,
  data: { ... },
  message: "Success"
};

// ❌ Bad: 임의의 응답 형식
return { result: { ... } };
```

### 6. 데이터베이스 작업

**데이터베이스 작업 시:**

1. `docs/development/database-schema.md`의 스키마 준수
2. 테이블명, 컬럼명 일관성 유지
3. 외래키 관계 정확히 설정
4. 인덱스 전략 참고

```typescript
// ✅ Good: 스키마 정의에 따른 모델 사용
const user = await prisma.user.findUnique({
  where: { id: userId },
  include: { teacher: true }
});

// ❌ Bad: 스키마와 다른 필드명 사용
const user = await prisma.user.findUnique({
  where: { userId: userId } // 잘못된 필드명
});
```

### 7. Git 커밋 메시지

**Conventional Commits 준수:**

```bash
# ✅ Good
feat(curriculum): add curriculum creation form
fix(auth): resolve login redirect issue
docs(api): update API documentation

# ❌ Bad
update
fix bug
WIP
```

**타입:**
- `feat`: 새로운 기능
- `fix`: 버그 수정
- `docs`: 문서 변경
- `style`: 코드 포맷팅
- `refactor`: 코드 리팩토링
- `test`: 테스트 추가/수정
- `chore`: 빌드 설정, 패키지 등

### 8. 코드 리뷰 체크리스트

**PR 전 자가 체크:**

- [ ] 문서의 요구사항을 충족하는가?
- [ ] 디자인 시스템을 준수하는가?
- [ ] 코딩 컨벤션을 따르는가?
- [ ] 에러 처리가 적절한가?
- [ ] 테스트가 작성되었는가?
- [ ] 주석이 필요한 부분에 작성되었는가?

## AI 통합 가이드

### AI 프롬프트 작성 시

1. **명확한 컨텍스트 제공**
   - 학년, 과목, 난이도 등 명시
   - 학습 목표 및 핵심 개념 포함

2. **구조화된 출력 요청**
   - JSON 형식으로 응답 요청
   - 필수 필드 명시

3. **예시 제공**
   - Few-shot learning 활용
   - 좋은 예시와 나쁜 예시 모두 제공

```typescript
// ✅ Good: 구조화된 프롬프트
const prompt = `
당신은 영어 교육 전문가입니다.
다음 정보를 바탕으로 문제를 생성해주세요:

- 단원: ${unitName}
- 학습 목표: ${learningObjectives}
- 난이도: ${difficulty}
- 문제 유형: ${questionType}

JSON 형식으로 응답해주세요:
{
  "question": "문제 내용",
  "choices": [...],
  "correctAnswer": "정답",
  "explanation": "설명"
}
`;
```

## 성능 최적화

### 1. React 최적화

```tsx
// ✅ Good: 메모이제이션 활용
const MemoizedComponent = React.memo(({ data }) => {
  return <div>{data}</div>;
});

const expensiveValue = useMemo(() => {
  return computeExpensiveValue(data);
}, [data]);

// ✅ Good: useCallback 활용
const handleClick = useCallback(() => {
  doSomething(id);
}, [id]);
```

### 2. 데이터베이스 쿼리 최적화

```typescript
// ✅ Good: 필요한 필드만 선택
const users = await prisma.user.findMany({
  select: {
    id: true,
    name: true,
    email: true
  }
});

// ✅ Good: 인덱스 활용
// 자주 조회되는 필드에 인덱스 설정 (database-schema.md 참고)
```

## 보안 가이드

### 1. 입력 검증

```typescript
// ✅ Good: 입력 검증
import { z } from 'zod';

const userSchema = z.object({
  email: z.string().email(),
  password: z.string().min(8),
  name: z.string().min(2).max(100)
});

const validatedData = userSchema.parse(input);
```

### 2. 인증/인가

```typescript
// ✅ Good: 권한 확인
if (user.role !== 'teacher') {
  throw new ForbiddenError('Only teachers can create curriculum');
}

// ✅ Good: 리소스 소유권 확인
const curriculum = await getCurriculum(id);
if (curriculum.teacherId !== user.teacherId) {
  throw new ForbiddenError('Not authorized');
}
```

## 테스트 작성

### 1. 단위 테스트

```typescript
// ✅ Good: 명확한 테스트 케이스
describe('calculateScore', () => {
  it('should return 100 when all answers are correct', () => {
    const score = calculateScore(10, 10);
    expect(score).toBe(100);
  });

  it('should return 0 when no answers are correct', () => {
    const score = calculateScore(0, 10);
    expect(score).toBe(0);
  });
});
```

### 2. E2E 테스트

```typescript
// ✅ Good: 사용자 시나리오 기반 테스트
test('teacher can create and assign curriculum', async ({ page }) => {
  await page.goto('/teacher/curriculum/new');
  await page.fill('[name="name"]', '2025 중1 영어');
  await page.click('button:has-text("저장")');
  await expect(page).toHaveURL(/\/curriculum\/[a-z0-9-]+/);
});
```

## 문서 업데이트

**코드 변경 시 관련 문서도 함께 업데이트해야 합니다:**

1. 새로운 API 추가 → `docs/api/api-specification.md` 업데이트
2. DB 스키마 변경 → `docs/development/database-schema.md` 업데이트
3. 새로운 컴포넌트 추가 → `docs/design/component-library.md` 업데이트
4. 기능 변경 → `docs/planning/feature-specification.md` 업데이트

## 문의 및 지원

문서 관련 문의사항이나 개선 제안은 프로젝트 관리자에게 연락하세요.

---

**이 규칙을 준수하여 일관성 있고 유지보수 가능한 코드를 작성합시다!** 🚀

